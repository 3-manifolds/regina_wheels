From d0f0a93c091bb589ce6f2718b42e474376c564f4 Mon Sep 17 00:00:00 2001
From: Matthias Goerner <1239022+unhyperbolic@users.noreply.github.com>
Date: Tue, 21 Dec 2021 18:41:50 -0800
Subject: [PATCH] Patch

---
 engine/link/gauss.cpp       |  2 +-
 engine/utilities/intutils.h |  8 ++++++++
 python/regina/__init__.py   | 11 +++++++++++
 3 files changed, 20 insertions(+), 1 deletion(-)

diff --git a/engine/link/gauss.cpp b/engine/link/gauss.cpp
index 549c7902d..89e238ff2 100644
--- a/engine/link/gauss.cpp
+++ b/engine/link/gauss.cpp
@@ -48,7 +48,7 @@
 // require macOS 10.15 (e.g., parts that use std::filesystem::path).
 // So on macOS we will assume that std::to_chars() is available.
 //
-#if __has_include(<charconv>)
+#if 0 && __has_include(<charconv>)
   #include <charconv>
   // We can use std::to_chars().
   #define __regina_has_to_chars 1
diff --git a/engine/utilities/intutils.h b/engine/utilities/intutils.h
index e4463fc40..14a70ac15 100644
--- a/engine/utilities/intutils.h
+++ b/engine/utilities/intutils.h
@@ -283,6 +283,14 @@ struct IntOfSize<8> {
     using utype = uint64_t;
 };
 
+#if ULONG_MAX > 4294967295
+#if __GNUC__
+#define INTERNAL___INT128_T_FOUND
+#else
+#define INTERNAL___INT128_FOUND
+#endif
+#endif
+
 #if defined(INTERNAL___INT128_FOUND)
     #define INT128_AVAILABLE
     template <>
diff --git a/python/regina/__init__.py b/python/regina/__init__.py
index 384a3aa92..e2ce1ca9a 100644
--- a/python/regina/__init__.py
+++ b/python/regina/__init__.py
@@ -65,6 +65,17 @@ else:
           if name != 'open' and not name.startswith('_') ] +
         [ 'reginaSetup' ])
 
+# In sageRegina, the census files are supplied differently.
+# Set the location here.
+try:
+    from .pyCensus import __path__ as _pyCensusPath
+    GlobalDirs.setDirs(
+        GlobalDirs.home(),
+        GlobalDirs.pythonModule(),
+        _pyCensusPath[0])
+except ImportError:
+    pass
+
 def reginaSetup(quiet = False, readline = True, banner = False,
                 snappyPath = True, namespace = None, builtinOpen = True):
     """
-- 
2.21.0 (Apple Git-122)

